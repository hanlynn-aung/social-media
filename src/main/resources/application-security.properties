# ==========================================
# Security Configuration
# ==========================================

# ==========================================
# JWT Configuration
# ==========================================

app.jwtSecret=${JWT_SECRET:your-super-secret-key-change-in-production}
app.jwtExpirationMs=86400000

# ==========================================
# Rate Limiting (Bucket4j)
# ==========================================

spring.security.rate-limiting.enabled=true
spring.security.rate-limiting.anonymous=10
spring.security.rate-limiting.user=100
spring.security.rate-limiting.shop-admin=300
spring.security.rate-limiting.admin=500

# Endpoint-specific limits
spring.security.rate-limiting.upload-endpoint=5
spring.security.rate-limiting.auth-endpoint=5
spring.security.rate-limiting.message-endpoint=30

# ==========================================
# Audit Logging (MongoDB)
# ==========================================

spring.security.audit-logging.enabled=true
spring.data.mongodb.audit-collection=audit_logs
spring.security.audit-logging.retention-days=90

# Sensitive operations to audit
spring.security.audit-logging.sensitive-actions=\
  USER_MANAGEMENT_CREATE,\
  USER_MANAGEMENT_UPDATE,\
  USER_MANAGEMENT_DELETE,\
  SHOP_MANAGEMENT_CREATE,\
  SHOP_MANAGEMENT_UPDATE,\
  SHOP_MANAGEMENT_DELETE,\
  DELETE

# ==========================================
# Request Signing (HMAC-SHA256)
# ==========================================

security.request-signing.enabled=false
security.request-signing.secret=${SIGNING_SECRET:default-secret-key}
security.request-signing.max-timestamp-diff=300000

# Protected endpoints
security.request-signing.protected-endpoints=\
  /api/users/delete,\
  /api/shops/delete,\
  /api/admin/*,\
  /api/auth/signup

# ==========================================
# IP Whitelisting
# ==========================================

security.ip-whitelist.enabled=false
security.ip-whitelist.ips=127.0.0.1,localhost,::1
security.ip-whitelist.paths=/api/admin/,/api/users/
security.ip-whitelist.allow-localhost=true

# ==========================================
# Fine-Grained Permissions
# ==========================================

spring.security.fine-grained-permissions.enabled=true
spring.security.fine-grained-permissions.strategy=HYBRID
spring.security.fine-grained-permissions.cache.enabled=true
spring.security.fine-grained-permissions.cache.ttl=300

# ==========================================
# Security Headers
# ==========================================

security.headers.csp=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'
security.headers.x-content-type-options=nosniff
security.headers.x-frame-options=DENY

# ==========================================
# Security Logging
# ==========================================

logging.level.com.example.socialmedia.security=INFO
logging.level.com.example.socialmedia.audit=DEBUG
logging.level.org.springframework.security=WARN
logging.level.org.springframework.security.authentication=WARN
